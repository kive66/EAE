2023-03-02 11:45:48,033 - config.py - 111 - INFO - ******HYPER-PARAMETERS******
2023-03-02 11:45:48,033 - config.py - 113 - INFO - exp_purpose: decode
2023-03-02 11:45:48,034 - config.py - 113 - INFO - model: bert
2023-03-02 11:45:48,034 - config.py - 113 - INFO - dataset: rams
2023-03-02 11:45:48,034 - config.py - 113 - INFO - train_path: data/rams/decoder/train.json
2023-03-02 11:45:48,034 - config.py - 113 - INFO - test_path: data/rams/decoder/test.json
2023-03-02 11:45:48,034 - config.py - 113 - INFO - exp_path: ./exp/
2023-03-02 11:45:48,034 - config.py - 113 - INFO - save_path: exp/2023-03-02/rams_bert_20230302114547/best.pth
2023-03-02 11:45:48,034 - config.py - 113 - INFO - project_path: ./
2023-03-02 11:45:48,034 - config.py - 113 - INFO - save_scriptList: ['utils', 'models', 'trainer', 'configs']
2023-03-02 11:45:48,034 - config.py - 113 - INFO - do_train: True
2023-03-02 11:45:48,034 - config.py - 113 - INFO - do_test: False
2023-03-02 11:45:48,034 - config.py - 113 - INFO - require_improvement: 200000000
2023-03-02 11:45:48,034 - config.py - 113 - INFO - num_epochs: 20
2023-03-02 11:45:48,034 - config.py - 113 - INFO - batch_size: 1
2023-03-02 11:45:48,034 - config.py - 113 - INFO - test_batch_size: 1
2023-03-02 11:45:48,034 - config.py - 113 - INFO - max_seq_len: 512
2023-03-02 11:45:48,034 - config.py - 113 - INFO - eval_step: 1400
2023-03-02 11:45:48,034 - config.py - 113 - INFO - log_step: 100
2023-03-02 11:45:48,034 - config.py - 113 - INFO - pretrain_path: bert-base-uncased
2023-03-02 11:45:48,034 - config.py - 113 - INFO - hidden_size: 768
2023-03-02 11:45:48,034 - config.py - 113 - INFO - logger: <Logger 20230302114547 (DEBUG)>
2023-03-02 11:45:48,034 - config.py - 113 - INFO - tokenizer: BertTokenizerFast(name_or_path='bert-base-uncased', vocab_size=30522, model_max_length=512, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'unk_token': '[UNK]', 'sep_token': '[SEP]', 'pad_token': '[PAD]', 'cls_token': '[CLS]', 'mask_token': '[MASK]'})
2023-03-02 11:45:48,034 - config.py - 113 - INFO - device: cuda
2023-03-02 11:45:48,035 - config.py - 113 - INFO - basic_learning_rate: 0.0001
2023-03-02 11:45:48,035 - config.py - 113 - INFO - encoder_learning_rate: 3e-05
2023-03-02 11:45:48,035 - config.py - 113 - INFO - rate_warmup_steps: 0.1
2023-03-02 11:45:48,035 - config.py - 113 - INFO - shuffle: True
2023-03-02 11:45:48,035 - config.py - 113 - INFO - drop_last: True
2023-03-02 11:45:48,035 - config.py - 113 - INFO - num_workers: 4
2023-03-02 11:45:48,035 - config.py - 113 - INFO - startTime: 20230302114547
2023-03-02 11:45:48,035 - config.py - 113 - INFO - dev_path: data/rams/decoder/dev.json
2023-03-02 11:45:48,035 - config.py - 113 - INFO - path: exp/2023-03-02/rams_bert_20230302114547
2023-03-02 11:45:48,035 - config.py - 113 - INFO - log_path: exp/2023-03-02/rams_bert_20230302114547/logs.log
2023-03-02 11:45:48,035 - config.py - 113 - INFO - tensorBoard_path: exp/2023-03-02/rams_bert_20230302114547/tensorboard
2023-03-02 11:45:48,035 - config.py - 113 - INFO - script_path: exp/2023-03-02/rams_bert_20230302114547/script
2023-03-02 11:45:48,035 - config.py - 113 - INFO - threshold: 0.4
2023-03-02 11:45:48,035 - config.py - 113 - INFO - max_desc_seq_len: 512
2023-03-02 11:45:48,035 - config.py - 113 - INFO - drop_rate: 0.5
2023-03-02 11:45:48,035 - config.py - 113 - INFO - max_role_num: 5
2023-03-02 11:45:48,035 - config.py - 113 - INFO - event_path: data/rams/event_role_multiplicities.txt
2023-03-02 11:45:48,035 - config.py - 113 - INFO - tbWriter: <torch.utils.tensorboard.writer.SummaryWriter object at 0x7f756ed95400>
2023-03-02 11:45:48,035 - config.py - 114 - INFO - ****************************
2023-03-02 11:45:54,444 - decoder_train.py - 36 - INFO - load train set......
2023-03-02 11:45:56,472 - decoder_train.py - 40 - INFO - load test set......
2023-03-02 11:45:56,641 - basic_trainer.py - 179 - INFO - ******************** Epoch: 1/20 ***********************
2023-03-02 11:45:57,600 - basic_trainer.py - 191 - INFO - step: 0/7327, Train loss: 23.97
2023-03-02 11:47:25,052 - basic_trainer.py - 191 - INFO - step: 100/7327, Train loss: 130.47
2023-03-02 11:48:52,235 - basic_trainer.py - 191 - INFO - step: 200/7327, Train loss: 110.35
2023-03-02 11:50:19,734 - basic_trainer.py - 191 - INFO - step: 300/7327, Train loss: 62.67
2023-03-02 11:51:46,729 - basic_trainer.py - 191 - INFO - step: 400/7327, Train loss: 23.43
2023-03-02 11:53:13,752 - basic_trainer.py - 191 - INFO - step: 500/7327, Train loss: 19.29
2023-03-02 11:54:41,115 - basic_trainer.py - 191 - INFO - step: 600/7327, Train loss: 14.48
2023-03-02 11:56:08,016 - basic_trainer.py - 191 - INFO - step: 700/7327, Train loss: 15.15
2023-03-02 11:57:35,256 - basic_trainer.py - 191 - INFO - step: 800/7327, Train loss: 15.88
2023-03-02 11:59:01,580 - basic_trainer.py - 191 - INFO - step: 900/7327, Train loss: 13.75
2023-03-02 12:00:30,010 - basic_trainer.py - 191 - INFO - step: 1000/7327, Train loss: 14.47
2023-03-02 12:01:57,136 - basic_trainer.py - 191 - INFO - step: 1100/7327, Train loss: 15.19
2023-03-02 12:03:22,949 - basic_trainer.py - 191 - INFO - step: 1200/7327, Train loss: 14.13
2023-03-02 12:04:49,014 - basic_trainer.py - 191 - INFO - step: 1300/7327, Train loss: 12.39
2023-03-02 12:06:16,668 - basic_trainer.py - 191 - INFO - step: 1400/7327, Train loss: 15.21
2023-03-02 12:06:16,696 - basic_trainer.py - 230 - INFO - *****evaluating*****
2023-03-02 12:10:13,157 - decoder_trainer.py - 78 - INFO - Test loss: 14.18
2023-03-02 12:10:13,158 - decoder_trainer.py - 79 - INFO - ---------------------------------------------------------------------
2023-03-02 12:10:13,158 - decoder_trainer.py - 80 - INFO - Arg      - P:   0.00            , R:   0.00            , F:   0.00
2023-03-02 12:10:13,158 - decoder_trainer.py - 82 - INFO - ---------------------------------------------------------------------
2023-03-02 12:10:13,656 - basic_trainer.py - 235 - INFO - step: 1400/7327, test acc: 0, Time usage: 0:24:17 [*]
2023-03-02 12:11:40,693 - basic_trainer.py - 191 - INFO - step: 1500/7327, Train loss: 11.90
2023-03-02 12:13:08,192 - basic_trainer.py - 191 - INFO - step: 1600/7327, Train loss: 14.28
2023-03-02 12:14:33,933 - basic_trainer.py - 191 - INFO - step: 1700/7327, Train loss: 12.88
2023-03-02 12:16:02,461 - basic_trainer.py - 191 - INFO - step: 1800/7327, Train loss: 13.30
2023-03-02 12:17:29,810 - basic_trainer.py - 191 - INFO - step: 1900/7327, Train loss: 14.51
2023-03-02 12:18:56,779 - basic_trainer.py - 191 - INFO - step: 2000/7327, Train loss: 14.34
2023-03-02 12:20:24,054 - basic_trainer.py - 191 - INFO - step: 2100/7327, Train loss: 14.40
2023-03-02 12:21:49,886 - basic_trainer.py - 191 - INFO - step: 2200/7327, Train loss: 13.28
2023-03-02 12:23:14,891 - basic_trainer.py - 191 - INFO - step: 2300/7327, Train loss: 14.00
2023-03-02 12:24:40,907 - basic_trainer.py - 191 - INFO - step: 2400/7327, Train loss: 11.52
2023-03-02 12:26:07,383 - basic_trainer.py - 191 - INFO - step: 2500/7327, Train loss: 12.11
2023-03-02 12:27:31,697 - basic_trainer.py - 191 - INFO - step: 2600/7327, Train loss: 10.85
2023-03-02 12:28:58,087 - basic_trainer.py - 191 - INFO - step: 2700/7327, Train loss: 14.16
2023-03-02 12:30:23,947 - basic_trainer.py - 191 - INFO - step: 2800/7327, Train loss: 12.56
2023-03-02 12:30:23,975 - basic_trainer.py - 230 - INFO - *****evaluating*****
2023-03-02 12:34:20,625 - decoder_trainer.py - 78 - INFO - Test loss: 12.71
2023-03-02 12:34:20,626 - decoder_trainer.py - 79 - INFO - ---------------------------------------------------------------------
2023-03-02 12:34:20,627 - decoder_trainer.py - 80 - INFO - Arg      - P:   0.00            , R:   0.00            , F:   0.00
2023-03-02 12:34:20,627 - decoder_trainer.py - 82 - INFO - ---------------------------------------------------------------------
2023-03-02 12:34:20,778 - basic_trainer.py - 235 - INFO - step: 2800/7327, test acc: 0, Time usage: 0:48:24 
2023-03-02 12:35:48,476 - basic_trainer.py - 191 - INFO - step: 2900/7327, Train loss: 11.96
2023-03-02 12:37:15,615 - basic_trainer.py - 191 - INFO - step: 3000/7327, Train loss: 13.08
2023-03-02 12:38:40,790 - basic_trainer.py - 191 - INFO - step: 3100/7327, Train loss: 11.30
2023-03-02 12:40:09,717 - basic_trainer.py - 191 - INFO - step: 3200/7327, Train loss: 12.38
2023-03-02 12:41:38,184 - basic_trainer.py - 191 - INFO - step: 3300/7327, Train loss: 12.27
2023-03-02 12:43:06,229 - basic_trainer.py - 191 - INFO - step: 3400/7327, Train loss: 13.21
2023-03-02 12:44:34,949 - basic_trainer.py - 191 - INFO - step: 3500/7327, Train loss: 13.95
2023-03-02 12:46:03,037 - basic_trainer.py - 191 - INFO - step: 3600/7327, Train loss: 14.26
2023-03-02 12:47:31,939 - basic_trainer.py - 191 - INFO - step: 3700/7327, Train loss: 11.40
2023-03-02 12:48:57,104 - basic_trainer.py - 191 - INFO - step: 3800/7327, Train loss: 10.88
2023-03-02 12:50:22,221 - basic_trainer.py - 191 - INFO - step: 3900/7327, Train loss: 12.05
2023-03-02 12:51:50,050 - basic_trainer.py - 191 - INFO - step: 4000/7327, Train loss: 13.55
2023-03-02 12:53:16,456 - basic_trainer.py - 191 - INFO - step: 4100/7327, Train loss: 11.84
2023-03-02 12:54:42,859 - basic_trainer.py - 191 - INFO - step: 4200/7327, Train loss: 12.27
2023-03-02 12:54:42,887 - basic_trainer.py - 230 - INFO - *****evaluating*****
2023-03-02 12:58:40,391 - decoder_trainer.py - 78 - INFO - Test loss: 12.35
2023-03-02 12:58:40,392 - decoder_trainer.py - 79 - INFO - ---------------------------------------------------------------------
2023-03-02 12:58:40,392 - decoder_trainer.py - 80 - INFO - Arg      - P:   0.00            , R:   0.00            , F:   0.00
2023-03-02 12:58:40,392 - decoder_trainer.py - 82 - INFO - ---------------------------------------------------------------------
2023-03-02 12:58:40,879 - basic_trainer.py - 235 - INFO - step: 4200/7327, test acc: 0, Time usage: 1:12:44 
2023-03-02 13:00:06,806 - basic_trainer.py - 191 - INFO - step: 4300/7327, Train loss: 12.07
2023-03-02 13:01:33,317 - basic_trainer.py - 191 - INFO - step: 4400/7327, Train loss: 10.94
2023-03-02 13:03:00,144 - basic_trainer.py - 191 - INFO - step: 4500/7327, Train loss: 10.54
2023-03-02 13:04:26,432 - basic_trainer.py - 191 - INFO - step: 4600/7327, Train loss: 12.78
2023-03-02 13:05:54,169 - basic_trainer.py - 191 - INFO - step: 4700/7327, Train loss: 12.13
2023-03-02 13:07:21,458 - basic_trainer.py - 191 - INFO - step: 4800/7327, Train loss: 13.02
2023-03-02 13:08:51,058 - basic_trainer.py - 191 - INFO - step: 4900/7327, Train loss: 13.63
2023-03-02 13:10:17,199 - basic_trainer.py - 191 - INFO - step: 5000/7327, Train loss: 15.34
2023-03-02 13:11:43,905 - basic_trainer.py - 191 - INFO - step: 5100/7327, Train loss: 14.15
2023-03-02 13:13:13,206 - basic_trainer.py - 191 - INFO - step: 5200/7327, Train loss: 11.29
2023-03-02 13:14:38,673 - basic_trainer.py - 191 - INFO - step: 5300/7327, Train loss: 8.70
2023-03-02 13:16:06,802 - basic_trainer.py - 191 - INFO - step: 5400/7327, Train loss: 12.35
2023-03-02 13:17:35,193 - basic_trainer.py - 191 - INFO - step: 5500/7327, Train loss: 12.53
2023-03-02 13:19:01,059 - basic_trainer.py - 191 - INFO - step: 5600/7327, Train loss: 11.26
2023-03-02 13:19:01,088 - basic_trainer.py - 230 - INFO - *****evaluating*****
2023-03-02 13:22:58,227 - decoder_trainer.py - 78 - INFO - Test loss: 12.11
2023-03-02 13:22:58,228 - decoder_trainer.py - 79 - INFO - ---------------------------------------------------------------------
2023-03-02 13:22:58,228 - decoder_trainer.py - 80 - INFO - Arg      - P:  33.33            , R:   0.20            , F:   0.20
2023-03-02 13:22:58,229 - decoder_trainer.py - 82 - INFO - ---------------------------------------------------------------------
2023-03-02 13:22:58,710 - basic_trainer.py - 235 - INFO - step: 5600/7327, test acc: 0.001974333662388944, Time usage: 1:37:02 [*]
2023-03-02 13:24:27,251 - basic_trainer.py - 191 - INFO - step: 5700/7327, Train loss: 14.33
2023-03-02 13:25:52,858 - basic_trainer.py - 191 - INFO - step: 5800/7327, Train loss: 10.01
2023-03-02 13:27:19,468 - basic_trainer.py - 191 - INFO - step: 5900/7327, Train loss: 11.93
2023-03-02 13:28:46,293 - basic_trainer.py - 191 - INFO - step: 6000/7327, Train loss: 10.88
2023-03-02 13:30:12,553 - basic_trainer.py - 191 - INFO - step: 6100/7327, Train loss: 10.66
2023-03-02 13:31:38,942 - basic_trainer.py - 191 - INFO - step: 6200/7327, Train loss: 11.02
2023-03-02 13:33:05,919 - basic_trainer.py - 191 - INFO - step: 6300/7327, Train loss: 11.91
2023-03-02 13:34:32,538 - basic_trainer.py - 191 - INFO - step: 6400/7327, Train loss: 12.04
2023-03-02 13:35:57,335 - basic_trainer.py - 191 - INFO - step: 6500/7327, Train loss: 10.35
2023-03-02 13:37:23,317 - basic_trainer.py - 191 - INFO - step: 6600/7327, Train loss: 11.72
2023-03-02 13:38:51,677 - basic_trainer.py - 191 - INFO - step: 6700/7327, Train loss: 12.10
2023-03-02 13:40:19,233 - basic_trainer.py - 191 - INFO - step: 6800/7327, Train loss: 12.47
2023-03-02 13:41:45,268 - basic_trainer.py - 191 - INFO - step: 6900/7327, Train loss: 9.01
2023-03-02 13:43:12,232 - basic_trainer.py - 191 - INFO - step: 7000/7327, Train loss: 11.15
2023-03-02 13:43:12,260 - basic_trainer.py - 230 - INFO - *****evaluating*****
2023-03-02 13:47:09,587 - decoder_trainer.py - 78 - INFO - Test loss: 11.40
2023-03-02 13:47:09,588 - decoder_trainer.py - 79 - INFO - ---------------------------------------------------------------------
2023-03-02 13:47:09,588 - decoder_trainer.py - 80 - INFO - Arg      - P:  16.07            , R:  12.81            , F:  12.81
2023-03-02 13:47:09,588 - decoder_trainer.py - 82 - INFO - ---------------------------------------------------------------------
2023-03-02 13:47:09,788 - basic_trainer.py - 235 - INFO - step: 7000/7327, test acc: 0.12805241215008933, Time usage: 2:01:13 [*]
2023-03-02 13:48:37,225 - basic_trainer.py - 191 - INFO - step: 7100/7327, Train loss: 10.02
2023-03-02 13:50:03,141 - basic_trainer.py - 191 - INFO - step: 7200/7327, Train loss: 10.50
2023-03-02 13:51:33,063 - basic_trainer.py - 191 - INFO - step: 7300/7327, Train loss: 12.11
2023-03-02 13:51:56,090 - basic_trainer.py - 179 - INFO - ******************** Epoch: 2/20 ***********************
2023-03-02 13:53:01,626 - basic_trainer.py - 191 - INFO - step: 73/7327, Train loss: 10.37
2023-03-02 13:54:29,429 - basic_trainer.py - 191 - INFO - step: 173/7327, Train loss: 13.78
2023-03-02 13:55:57,969 - basic_trainer.py - 191 - INFO - step: 273/7327, Train loss: 10.65
2023-03-02 13:57:24,708 - basic_trainer.py - 191 - INFO - step: 373/7327, Train loss: 9.21
2023-03-02 13:58:52,161 - basic_trainer.py - 191 - INFO - step: 473/7327, Train loss: 9.83
2023-03-02 14:00:20,809 - basic_trainer.py - 191 - INFO - step: 573/7327, Train loss: 12.31
2023-03-02 14:01:47,377 - basic_trainer.py - 191 - INFO - step: 673/7327, Train loss: 10.21
2023-03-02 14:03:13,926 - basic_trainer.py - 191 - INFO - step: 773/7327, Train loss: 11.59
2023-03-02 14:04:41,549 - basic_trainer.py - 191 - INFO - step: 873/7327, Train loss: 10.38
2023-03-02 14:06:07,674 - basic_trainer.py - 191 - INFO - step: 973/7327, Train loss: 9.76
2023-03-02 14:07:36,850 - basic_trainer.py - 191 - INFO - step: 1073/7327, Train loss: 8.53
2023-03-02 14:07:36,879 - basic_trainer.py - 230 - INFO - *****evaluating*****
